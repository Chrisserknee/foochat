# Admin Page Analyses Dashboard

## Overview
This system automatically captures and stores every screenshot submitted to the Page Analyzer, along with all user information and AI analysis results. Everything is stored securely in Supabase and only accessible to you (the admin).

## What Gets Stored

For each analysis, the system **automatically** saves:
- ‚úÖ **Screenshot** - The actual image uploaded by the user
- ‚úÖ **User Information** - Automatically extracted by AI from the screenshot:
  - Username/handle
  - Full name/display name
  - Follower count
  - Post count
  - Bio links
  - Social media profile URL
- ‚úÖ **AI Analysis** - The complete analysis text generated by GPT-4o Vision
- ‚úÖ **Timestamp** - When the analysis was performed
- ‚úÖ **User ID** - If the user was logged in (null if anonymous)

**Note:** All user information is automatically extracted from the screenshot using GPT-4o Vision - no manual input required from users!

## Storage Details

### Database Table: `page_analyses`
Located in Supabase with the following columns:
- `id` - Unique identifier
- `user_id` - User's ID (if logged in)
- `username` - Social media username
- `full_name` - User's full name
- `bio_links` - Links from bio
- `follower_count` - Number of followers
- `post_count` - Number of posts
- `social_link` - Direct link to profile
- `analysis_text` - Full AI analysis
- `screenshot_url` - Filename in storage bucket
- `created_at` - Timestamp

### Storage Bucket: `page-screenshots`
- Private bucket (not publicly accessible)
- Only accessible via service role key
- Screenshots stored with unique filenames: `screenshot-{timestamp}-{random}.png`

## How to Access the Data

### Method 1: Admin Dashboard (Recommended)
Visit: `http://localhost:3000/admin/page-analyses` (or your production URL)

**Password:** `PostReady2025!` (see `ADMIN_SECURITY.md` to change)

Features:
- üîí **Password Protected** - Secure access to sensitive data
- üìä **View All Analyses** - Clean dashboard with all submissions
- üñºÔ∏è **View Screenshots** - See original uploaded images
- üì• **Export to CSV** - Download all data at once
- üóëÔ∏è **Permanent Deletion** - Remove analyses and screenshots
- üîç **Expandable Details** - Click to view full analysis
- üìà **Total Count** - See how many analyses you have

### Method 2: Direct API Access
**GET** `/api/admin/page-analyses`

Returns JSON with all analyses including signed URLs for screenshots.

Example response:
```json
{
  "success": true,
  "count": 5,
  "analyses": [
    {
      "id": "uuid",
      "username": "@johndoe",
      "full_name": "John Doe",
      "follower_count": "10.5k",
      "post_count": "234",
      "bio_links": "link1.com, link2.com",
      "social_link": "instagram.com/johndoe",
      "analysis_text": "Full AI analysis...",
      "screenshot_signed_url": "https://...",
      "created_at": "2025-11-18T..."
    }
  ]
}
```

### Method 3: Supabase Dashboard
1. Go to your Supabase project
2. Navigate to Table Editor
3. Open the `page_analyses` table
4. View all records directly

To view screenshots:
1. Go to Storage
2. Open `page-screenshots` bucket
3. Download any screenshot by filename

## Setup Instructions

### 1. Run the SQL Migration
Copy and run the contents of `supabase_migration_page_analyses.sql` in your Supabase SQL Editor.

This will:
- Create the `page_analyses` table
- Create the `page-screenshots` storage bucket
- Set up Row Level Security (RLS) policies
- Create indexes for faster queries

### 2. Verify Storage Bucket
After running the migration:
1. Go to Supabase ‚Üí Storage
2. Verify `page-screenshots` bucket exists
3. Confirm it's set to "Private"

### 3. Test the System
1. Go to your app's Page Analyzer
2. Upload a screenshot of any social media page
3. Click "Analyze Page"
4. The AI will automatically extract user info from the screenshot
5. Check the admin dashboard to see the stored data with extracted info

## Privacy & Security

- ‚úÖ **Private Storage** - Screenshots are in a private bucket, not publicly accessible
- ‚úÖ **Service Role Only** - Only server-side code with service role key can access
- ‚úÖ **User Consent** - Privacy notice displayed before using the tool
- ‚úÖ **RLS Policies** - Row Level Security ensures only service role can read/write
- ‚úÖ **Signed URLs** - Screenshots accessed via temporary signed URLs (1 hour expiry)
- ‚úÖ **Password Protected** - Admin dashboard requires password authentication
- ‚úÖ **Data Deletion** - Permanent deletion capability for compliance
- ‚úÖ **Data Export** - CSV export for data portability

## Notes

- Storage is automatic with user consent notice
- All data persists indefinitely unless manually deleted via admin dashboard
- Screenshots are stored in original quality
- Admin dashboard is password protected (default: `PostReady2025!`)
- Signed URLs expire after 1 hour for security
- CSV export includes all metadata except screenshots
- Deletion is permanent and cannot be undone

## Future Enhancements (Optional)

- ‚úÖ ~~Add admin authentication to protect the dashboard~~ **DONE**
- ‚úÖ ~~Export data to CSV/Excel~~ **DONE**
- ‚è≥ Add search and filter functionality
- ‚è≥ Set up automatic data retention policies
- ‚è≥ Add analytics and insights
- ‚è≥ Implement proper OAuth/JWT authentication
- ‚è≥ Add user-facing data deletion request form
- ‚è≥ Add bulk deletion capabilities

